{"file_path": "/Users/sz904/Desktop/11711/LTI_Neural_Navigator/data/2024-02-26/chunk_paper_txt/Yiming_Yang_Automatic_synchrotron_tomographic_alignment_schemes_based_on_genetic_algorithms_and_human-in-the-loop_software_chunk_2.txt", "num_qa_pairs": 10, "qa_list": [{"question": " What is the importance of aligning the rotation axis before the sample in tomography experiments?", "answer": " The quality degradation of the reconstructed structure due to the misalignment of the rotation axis is more difficult to compensate by reconstruction algorithms.", "ref_chunk": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}, {"question": " What are some of the methods used for post-acquisition sample alignment in tomography experiments?", "answer": " Post-acquisition sample alignment schemes include image processing techniques and iterative reconstruction-reprojection methods.", "ref_chunk": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}, {"question": " How did Vo et al. (2014) propose to align samples in tomography experiments?", "answer": " Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms.", "ref_chunk": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}, {"question": " What did Yang et al. (2017) use to reduce the horizontal drift problem in tomography experiments?", "answer": " Yang et al. (2017) used convolutional neural networks.", "ref_chunk": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}, {"question": " What is the main difference between the alignment methods that focus on post-acquisition processes and the alignment method discussed in the text?", "answer": " The alignment method discussed in the text focuses on pre-acquisition processes, aligning the rotation axis first and then the sample.", "ref_chunk": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}, {"question": " What role does genetic algorithm play in the alignment method discussed in the text?", "answer": " A genetic algorithm is introduced to optimize the motor position in the global scope for automatic alignment. It ensures globally optimized results without requiring gradient information or a mathematical model.", "ref_chunk": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}, {"question": " What is the purpose of conducting virtual tomography experiments in this study?", "answer": " Virtual tomography experiments were conducted for algorithm verification and software validation.", "ref_chunk": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}, {"question": " How does the Virtual Beamline Studio (VBS) help in simulating tomography experiments?", "answer": " VBS simulates multi-modal and high-data-throughput experiments at next-generation beamlines, allowing users to test and implement algorithms without a real experimental setup.", "ref_chunk": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}, {"question": " Why is the walnut sample used for rotation-axis and sample alignment tests in tomography experiments?", "answer": " The walnut sample is used as it has sharp features that can aid in aligning the rotation axis with respect to the detector.", "ref_chunk": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}, {"question": " How is the rotation axis aligned with respect to the detector in tomography experiments using the walnut sample?", "answer": " The rotation axis is aligned by adjusting motors (cid:3) and (cid:4) to account for the effect caused by the two orthogonal vectors Zt and Xt.", "ref_chunk": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}], "doc_text": "attenuation and its sinograms. Cheng et al. (2018) mini- mized the total deviation of the reconstructed image to correct problems such as errors resulting from incorrectly determined rotational axes and projection angles. However, comparing with other factors, the quality degradation of the recon- structed structure due to the misalignment of the rotation axis will be more dif\ufb01cult to compensate by reconstruction algo- rithms. Therefore, the rotation axis should be well aligned pre- acquisition. Once the rotation axis alignment is completed, the sample alignment procedures are ready to be initiated. In reality, the sample alignments with respect to the CoR are usually done at the post-acquisition stage. A wide range of post-acquisition sample alignment schemes based on image processing techniques (McEnvoy, 2007; Matula et al., 2003; Amat et al., 2008; Cheng et al., 2014; Pan et al., 2012; Robertson et al., 2015; Sorzano et al., 2020) or iterative reconstruction-reprojection (Nassi et al., 1982; Ollinger, 1990; Wang et al., 2000; Li et al., 2020) methods have been developed and have shown great effects. In particular, Vo et al. (2014) proposed a sample alignment scheme based on Fourier space sinograms. Yang et al. (2017) used convolutional neural networks to reduce the horizontal drift problem caused by aspects such as instrument instability. All the above methods show well aligned results in their respective application scenarios; however, most of them focus on the post-processing stage of tomography experiments, and these alignment algorithms cannot correct everything and are not time ef\ufb01cient. Therefore, in contrast to the above align- ment that concentrate on the post-acquisition process, we report here an alignment method in the pre- acquisition process that aligns the rotation axis \ufb01rst and then the sample. The method divides the work\ufb02ow of rotational- axis alignment and sample alignment into two steps \u2013 coarse alignment and \ufb01ne alignment \u2013 and provides a graphical user interface (GUI) and manual intervention to assist the align- ment procedure. In particular, the algorithm used for coarse alignment is based on a physical model and the process is usually very fast. To reach a more accurate alignment, a genetic algorithm (GA) (Kihm & Lyons, 1996) is introduced which can optimize the motor position in the global scope to realize an automatic alignment. The GA is a global optimi- zation algorithm which ensures the \ufb01nal results are globally optimized. Moreover, for a subjective function to be optimized by the GA, its gradient information and mathematical model are not required. The only necessary information is the output corresponding to a certain input. These facts lead to the conclusion that a GA-based optimization can be performed at any sample without parameter modi\ufb01cation. Virtual tomography experiments were conducted for the algorithm veri\ufb01cation and software validation; the results demonstrate that our method can achieve sub-pixel alignment accuracy. Human intervention through the designed GUI has also shown signi\ufb01cant importance in facilitating the alignment process. Together, our method has demonstrated great appli- cation potential for enhancing the data acquisition ef\ufb01ciency of future synchrotron scanning tomography experiments. schemes 2. Methods 2.1. Virtual tomography experiment The in-house-developed Virtual Beamline Studio (VBS) provides a test bed for veri\ufb01cation of the proposed algorithms in the paper. VBS was developed to simulate the future multi- modal and high-data-throughput experiments performed at the next-generation beamlines of the High Energy Photon Source (HEPS). The user can employ a certain combination of virtual detectors and motors to perform a virtual experiment in Mamba (Liu et al., 2022). The simulated detectors and motors share the sample protocols with real devices in terms of control and data communication in the data acquisition software framework (Mamba) developed for HEPS. The only difference is, instead of reading data from chips, the virtual detectors read images which are stored in memory or gener- ated from third-party simulation programs. The virtual experiment enables users to test and implement algorithms and software applications without a real experimental setup. To simulate tomography experiments, we developed a simu- lation model that generates projection images using recon- structed sample slices with de\ufb01ned measurement geometry (sample, beam and detector). In the procedure, this module performs rotation and integration operations on all recon- structed sample slices, and converts three-dimensional sample slices into a series of two-dimensional sample projection images according to the Radon transformation. The samples were simulated using the tomography dataset from Amat et al. (2008) and a XANES tomography dataset collected from Stanford Synchrotron Radiation Lightsource (SSRL). For the \ufb01rst set of walnut data, we selected the Feldkamp\u2013Davis\u2013 Kress (FDK) reconstruction data of the \ufb01rst set of walnuts as the primary sample. This is a collection of computed tomo- graphy slices that are highly aligned with no artifacts present and well suitable for algorithm development and evaluation for other tasks. Furthermore, the second dataset is the one that we would face in our actual scanning tomography experiments which is of great help for the validation of our algorithm. The simulated motors read the prede\ufb01ned trajectories to mimic the scans in real experiments. 2.2. Rotation-axis alignment During synchrotron experiments the rotation axis usually only needs to be realigned once for each beam time, and therefore users rarely use real samples to align the rotation axis but instead tend to use a specialized calibration sample with sharp features. For convenience, we use the walnut sample for both rotation-axis alignment and sample alignment tests. To facilitate the alignment of the rotation axis with respect to the detector, we randomly added a strong absorbing particle on the surface of the walnut sample. As shown in Fig. 2, the position of the sample can be represented by a 3D coordinate system, and the tilt of the rotation axis can be decomposed as a superposition of two orthogonal vectors Zt and Xt . For the effect caused by these two vectors ((cid:2)Zt and (cid:2)Xt), we can align the rotation axis by adjusting motor (cid:3) and motor (cid:4). It is necessary to note that in a real rotation-axis J. Synchrotron Rad. (2023). 30, 169\u2013178 Zhen Zhang et al. (cid:2) Automatic synchrotron tomographic alignment schemes"}